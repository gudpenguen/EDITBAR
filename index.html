<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>M&G Fiyat / Yolcu / EBITDAR (Dinamik Pax‑Epsilon)</title>

<link href="https://fonts.googleapis.com/css2?family=Libre+Franklin:wght@900&display=swap" rel="stylesheet">
<style>
 :root{--brown:#7b5944;--brown-dark:#6a4834;--border:#bca697;--white:#fff}
 body{font-family:"Century","Libre Franklin",sans-serif;background:var(--brown-dark);color:var(--white);margin:40px}
 h2{margin-top:0;font-weight:900}
 table{width:860px;border-collapse:collapse;background:var(--brown)}
 th,td{border:1px solid var(--border);padding:10px 12px;text-align:right;font-weight:900}
 th:first-child,td:first-child{text-align:left}
 input{width:140px;padding:6px 8px;background:var(--brown-dark);border:1px solid var(--border);color:var(--white);font-family:inherit;font-weight:900;text-align:right}
 input::placeholder{color:#d8d0ca}
 input[readonly]{color:#d8d0ca}
 .num{font-weight:900}
 section{max-width:860px;margin-top:22px;line-height:1.45;font-size:15px}
 section h3{margin:8px 0 4px;font-weight:900}
 ul{margin:4px 0 8px 16px;padding:0}
 code{background:rgba(255,255,255,0.08);padding:0 4px;border-radius:3px}
 .warning{margin-top:12px;font-size:14px;font-weight:700;color:#ffd}
</style>
</head>
<body>

<h2>Meet &amp; Greet — Hızlı Fiyat Analizi</h2>

<table>
<thead>
<tr><th>Gösterge</th><th>Mevcut</th><th>Yeni</th><th>Açıklama</th></tr>
</thead>
<tbody>
<!-- 1) Birim Fiyat -->
<tr>
  <td>*Birim Fiyat (€)</td>
  <td class="num" id="oldPrice">217</td>
  <td><input type="number" id="newPrice" placeholder="yeni fiyat" oninput="priceChanged()"></td>
  <td></td>
</tr>
<!-- 2) Toplam Gider -->
<tr>
  <td>*Toplam Gider (€)</td>
  <td class="num" id="oldCost">1 456 575</td>
  <td><input type="number" id="newCostInput" placeholder="otomatik" oninput="calc()"></td>
  <td>Varsayılan: <em>Birim&nbsp;Gider × Yolcu</em><br><span id="autoCostInfo">—</span></td>
</tr>
<!-- 3) Yolcu Sayısı -->
<tr>
  <td>*Yolcu Sayısı (pax)</td>
  <td class="num" id="oldPax">23 480</td>
  <td><input type="number" id="newPaxInput" placeholder="otomatik" oninput="paxChanged()"></td>
  <td></td>
</tr>
<!-- Remaining rows keep previous order -->
<tr>
  <td>Talep Esnekliği (ε)</td>
  <td class="num" id="oldEps">-0.57</td>
  <td><input type="number" id="newEps" placeholder="otomatik" readonly></td>
  <td class="num" id="epsPct">—</td>
</tr>
<tr>
  <td>Birim Gider (€)</td>
  <td class="num" id="unitCostOld">62</td>
  <td><input type="number" id="unitCostInput" placeholder="otomatik" oninput="calc()"></td>
  <td><span id="unitCostInfo">Varsayılan: 62 €</span></td>
</tr>
<tr><td>Toplam Gelir (€)</td><td class="num" id="oldRev">5 095 160</td><td class="num" id="newRev">—</td><td></td></tr>
<tr><td>EBITDAR (€)</td><td class="num" id="oldEbit">3 638 585</td><td class="num" id="newEbit">—</td><td></td></tr>
<tr><td>EBITDAR Marjı</td><td class="num" id="oldMarj">71.4 %</td><td class="num" id="newMarj">—</td><td></td></tr>
</tbody>
</table>

<p class="warning">⚠️ Toplam gider <strong>veya</strong> birim gider girişi yapabilirsiniz. <strong>İkisini aynı anda değiştirmeyin.</strong><br>⚠️ Yolcu sayısını değiştirirseniz ε otomatik hesaplanır. Fiyat her değiştiğinde yolcu otomatik güncellenir; gerekirse tekrar pax girerek üzerine yazabilirsiniz.<br>⚠️ Mevcut Veriler 2025 yılı Ocak ve Nisan Ayları arası olarak hesaplanmıştır. Aylık olarak hesaplama yapılması durumunda dikkate almayınız.</p>

<section>
<h3>Hesap Formülleri</h3>
<p>
  Yeni yolcu:&nbsp; <code>Q<sub>yeni</sub> = Q<sub>0</sub> × ( 1 + ε × ΔP / P<sub>0</sub> )</code><br>
  ε (otomatik):&nbsp; <code>ε = (Q<sub>yeni</sub>/Q<sub>0</sub> − 1) × (P<sub>0</sub>/ΔP)</code><br>
  Toplam gider:&nbsp; <code>Gider = Birim&nbsp;Gider × Yolcu</code><br>
  EBITDAR:&nbsp; <code>EBITDAR = (Fiyat × Yolcu) − Gider</code><br>
  EBITDAR&nbsp;Marjı:&nbsp; <code>EBITDAR&nbsp;/&nbsp;Gelir</code>
</p>
</section>

<script>
const P0 = 217;
const Q0 = 23480;
const U0 = 62;
const EPS0 = -0.57;

function fmt(n,d=0){return n.toLocaleString('tr-TR',{minimumFractionDigits:d,maximumFractionDigits:d});}

function priceChanged(){document.getElementById('newPaxInput').value='';calc();}
function paxChanged(){calc();}

function calc(){
  const priceVal = parseFloatOrNull('newPrice');
  if(priceVal===null||priceVal<=0){clearOutputs();return;}
  const unitVal = parseFloatOrNull('unitCostInput');
  const unitCost = unitVal!==null?unitVal:U0;
  const paxVal = parseIntOrNull('newPaxInput');
  const deltaP = priceVal-P0;
  let epsilon,newPax;
  if(paxVal!==null){epsilon=(deltaP!==0)?((paxVal/Q0)-1)*(P0/deltaP):EPS0;newPax=paxVal;}else{epsilon=EPS0;newPax=Math.round(Q0*(1+epsilon*deltaP/P0));document.getElementById('newPaxInput').placeholder=fmt(newPax);}  
  document.getElementById('newEps').value=fmt(epsilon,2);
  document.getElementById('epsPct').textContent=fmt(epsilon*100,1)+' %';
  const costManual=parseFloatOrNull('newCostInput');
  const cost=costManual!==null?costManual:unitCost*newPax;
  if(costManual===null){document.getElementById('newCostInput').placeholder='otomatik';}
  const impliedUnit=cost/newPax;
  if(unitVal===null){document.getElementById('unitCostInput').placeholder=fmt(impliedUnit,2);}  
  document.getElementById('unitCostInfo').textContent='Varsayılan: '+fmt(impliedUnit,2)+' €';
  document.getElementById('autoCostInfo').textContent=fmt(cost,0)+' €';
  const rev=priceVal*newPax;
  const ebit=rev-cost;
  const marj=rev?ebit/rev:0;
  document.getElementById('newRev').textContent=fmt(rev,0);
  document.getElementById('newEbit').textContent=fmt(ebit,0);
  document.getElementById('newMarj').textContent=fmt(marj*100,1)+' %';
}
function parseFloatOrNull(id){const v=document.getElementById(id).value.replace(',', '.');return v?parseFloat(v):null;}
function parseIntOrNull(id){const v=document.getElementById(id).value.replace(',', '.');return v?parseInt(v):null;}
function clearOutputs(){['newRev','newEbit','newMarj'].forEach(i=>document.getElementById(i).textContent='—');document.getElementById('epsPct').textContent='—';document.getElementById('unitCostInfo').textContent='Varsayılan: 62 €';document.getElementById('autoCostInfo').textContent='—';}
</script>

</body>
</html>
